+ set -euo pipefail
++ dirname ./sweep_vdt_adapter_k1_2_4_8_16.sh
+ cd ./..
+ DATA=/data1/suho/DATA
+ DATASET=oxford_pets
+ SEEDS=(${SEEDS:-1 2 3})
+ GPUS=(${GPUS:-0 1 2 3})
+ MIN_FREE_MEM=20000
+ PYTHON=python
+ TRAINER=CLIP_Adapter_gpt
+ CFG=vit_b16_c16_ep10_batch1
+ OUT_ROOT=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16
+ SPECS=("sgd|5e-4|0|50|4|False|end|cosine|0|linear|0|0.20|self_attn" "sgd|1e-3|5e-4|100|8|False|end|cosine|0|linear|0|0.20|self_attn" "sgd|2e-3|1e-3|100|8|True|end|cosine|0|linear|0|0.20|self_attn" "sgd|3e-3|1e-3|150|16|False|end|cosine|0|linear|0|0.20|self_attn" "sgd|5e-3|5e-3|150|16|True|middle|cosine|0|linear|0|0.20|self_attn" "sgd|1e-3|0|80|4|False|end|cosine|0|linear|0|0.20|self_attn" "sgd|2e-3|5e-4|120|8|False|end|cosine|0|linear|0|0.20|self_attn" "sgd|3e-3|1e-3|160|8|True|end|cosine|0|linear|0|0.20|self_attn" "sgd|5e-3|1e-3|200|16|False|end|cosine|0|linear|0|0.20|self_attn" "sgd|8e-3|5e-3|200|16|True|middle|cosine|0|linear|0|0.20|self_attn" "adamw|5e-5|0.01|50|4|False|end|cosine|0|linear|0|0.20|self_attn" "adamw|1e-4|0.02|100|8|False|end|cosine|0|linear|0|0.20|self_attn" "adamw|2e-4|0.02|100|8|True|end|cosine|0|linear|0|0.20|self_attn" "adamw|3e-4|0.02|150|16|False|end|cosine|0|linear|0|0.20|self_attn" "adamw|5e-4|0.05|150|16|True|middle|cosine|0|linear|0|0.20|self_attn" "adamw|1e-4|0.01|80|4|False|end|cosine|0|linear|0|0.20|self_attn" "adamw|2e-4|0.02|120|8|False|end|cosine|0|linear|0|0.20|self_attn" "adamw|3e-4|0.02|160|8|True|end|cosine|0|linear|0|0.20|self_attn" "adamw|5e-4|0.02|200|16|False|end|cosine|0|linear|0|0.20|self_attn" "adamw|8e-4|0.05|200|16|True|middle|cosine|0|linear|0|0.20|self_attn")
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16
+ for SHOTS in 1 2 4 8 16
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 5e-4 0 50 4 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=sgd LR=5e-4 WD=0 EPOCH=50 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 5e-4 OPTIM.WEIGHT_DECAY 0 OPTIM.MAX_EPOCH 50 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 5e-4 0 50 4 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=sgd LR=5e-4 WD=0 EPOCH=50 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 5e-4 OPTIM.WEIGHT_DECAY 0 OPTIM.MAX_EPOCH 50 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 5e-4 0 50 4 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=sgd LR=5e-4 WD=0 EPOCH=50 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 5e-4 OPTIM.WEIGHT_DECAY 0 OPTIM.MAX_EPOCH 50 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 1e-3 5e-4 100 8 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=sgd LR=1e-3 WD=5e-4 EPOCH=100 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 1e-3 OPTIM.WEIGHT_DECAY 5e-4 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 1e-3 5e-4 100 8 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=sgd LR=1e-3 WD=5e-4 EPOCH=100 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 1e-3 OPTIM.WEIGHT_DECAY 5e-4 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 1e-3 5e-4 100 8 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=sgd LR=1e-3 WD=5e-4 EPOCH=100 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 1e-3 OPTIM.WEIGHT_DECAY 5e-4 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 2e-3 1e-3 100 8 True end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=sgd LR=2e-3 WD=1e-3 EPOCH=100 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 2e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 2e-3 1e-3 100 8 True end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=sgd LR=2e-3 WD=1e-3 EPOCH=100 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 2e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 2e-3 1e-3 100 8 True end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=sgd LR=2e-3 WD=1e-3 EPOCH=100 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 2e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 3e-3 1e-3 150 16 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=sgd LR=3e-3 WD=1e-3 EPOCH=150 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 3e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 3e-3 1e-3 150 16 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=sgd LR=3e-3 WD=1e-3 EPOCH=150 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 3e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 3e-3 1e-3 150 16 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=sgd LR=3e-3 WD=1e-3 EPOCH=150 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 3e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 5e-3 5e-3 150 16 True middle cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=sgd LR=5e-3 WD=5e-3 EPOCH=150 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 5e-3 OPTIM.WEIGHT_DECAY 5e-3 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 5e-3 5e-3 150 16 True middle cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=sgd LR=5e-3 WD=5e-3 EPOCH=150 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 5e-3 OPTIM.WEIGHT_DECAY 5e-3 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 5e-3 5e-3 150 16 True middle cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=sgd LR=5e-3 WD=5e-3 EPOCH=150 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 5e-3 OPTIM.WEIGHT_DECAY 5e-3 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 1e-3 0 80 4 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=sgd LR=1e-3 WD=0 EPOCH=80 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 1e-3 OPTIM.WEIGHT_DECAY 0 OPTIM.MAX_EPOCH 80 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 1e-3 0 80 4 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=sgd LR=1e-3 WD=0 EPOCH=80 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 1e-3 OPTIM.WEIGHT_DECAY 0 OPTIM.MAX_EPOCH 80 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 1e-3 0 80 4 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=sgd LR=1e-3 WD=0 EPOCH=80 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 1e-3 OPTIM.WEIGHT_DECAY 0 OPTIM.MAX_EPOCH 80 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 2e-3 5e-4 120 8 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=sgd LR=2e-3 WD=5e-4 EPOCH=120 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 2e-3 OPTIM.WEIGHT_DECAY 5e-4 OPTIM.MAX_EPOCH 120 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 2e-3 5e-4 120 8 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=sgd LR=2e-3 WD=5e-4 EPOCH=120 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 2e-3 OPTIM.WEIGHT_DECAY 5e-4 OPTIM.MAX_EPOCH 120 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 2e-3 5e-4 120 8 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=sgd LR=2e-3 WD=5e-4 EPOCH=120 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 2e-3 OPTIM.WEIGHT_DECAY 5e-4 OPTIM.MAX_EPOCH 120 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 3e-3 1e-3 160 8 True end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=sgd LR=3e-3 WD=1e-3 EPOCH=160 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 3e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 160 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 3e-3 1e-3 160 8 True end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=sgd LR=3e-3 WD=1e-3 EPOCH=160 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 3e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 160 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 3e-3 1e-3 160 8 True end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=sgd LR=3e-3 WD=1e-3 EPOCH=160 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 3e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 160 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 5e-3 1e-3 200 16 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=sgd LR=5e-3 WD=1e-3 EPOCH=200 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 5e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 5e-3 1e-3 200 16 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=sgd LR=5e-3 WD=1e-3 EPOCH=200 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 5e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 5e-3 1e-3 200 16 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=sgd LR=5e-3 WD=1e-3 EPOCH=200 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 5e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 8e-3 5e-3 200 16 True middle cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=sgd LR=8e-3 WD=5e-3 EPOCH=200 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 8e-3 OPTIM.WEIGHT_DECAY 5e-3 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 8e-3 5e-3 200 16 True middle cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=sgd LR=8e-3 WD=5e-3 EPOCH=200 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 8e-3 OPTIM.WEIGHT_DECAY 5e-3 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 sgd 8e-3 5e-3 200 16 True middle cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=sgd LR=8e-3 WD=5e-3 EPOCH=200 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 8e-3 OPTIM.WEIGHT_DECAY 5e-3 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 5e-5 0.01 50 4 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=adamw LR=5e-5 WD=0.01 EPOCH=50 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 5e-5 OPTIM.WEIGHT_DECAY 0.01 OPTIM.MAX_EPOCH 50 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 5e-5 0.01 50 4 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=adamw LR=5e-5 WD=0.01 EPOCH=50 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 5e-5 OPTIM.WEIGHT_DECAY 0.01 OPTIM.MAX_EPOCH 50 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 5e-5 0.01 50 4 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=adamw LR=5e-5 WD=0.01 EPOCH=50 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME adamw OPTIM.LR 5e-5 OPTIM.WEIGHT_DECAY 0.01 OPTIM.MAX_EPOCH 50 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 1e-4 0.02 100 8 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=adamw LR=1e-4 WD=0.02 EPOCH=100 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 1e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 1e-4 0.02 100 8 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=adamw LR=1e-4 WD=0.02 EPOCH=100 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 1e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 1e-4 0.02 100 8 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=adamw LR=1e-4 WD=0.02 EPOCH=100 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME adamw OPTIM.LR 1e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 2e-4 0.02 100 8 True end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=adamw LR=2e-4 WD=0.02 EPOCH=100 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 2e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 2e-4 0.02 100 8 True end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=adamw LR=2e-4 WD=0.02 EPOCH=100 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 2e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 2e-4 0.02 100 8 True end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=adamw LR=2e-4 WD=0.02 EPOCH=100 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME adamw OPTIM.LR 2e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 3e-4 0.02 150 16 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=adamw LR=3e-4 WD=0.02 EPOCH=150 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 3e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 3e-4 0.02 150 16 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=adamw LR=3e-4 WD=0.02 EPOCH=150 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 3e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 3e-4 0.02 150 16 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=adamw LR=3e-4 WD=0.02 EPOCH=150 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME adamw OPTIM.LR 3e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 5e-4 0.05 150 16 True middle cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=adamw LR=5e-4 WD=0.05 EPOCH=150 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 5e-4 OPTIM.WEIGHT_DECAY 0.05 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 5e-4 0.05 150 16 True middle cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=adamw LR=5e-4 WD=0.05 EPOCH=150 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 5e-4 OPTIM.WEIGHT_DECAY 0.05 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 5e-4 0.05 150 16 True middle cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=adamw LR=5e-4 WD=0.05 EPOCH=150 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME adamw OPTIM.LR 5e-4 OPTIM.WEIGHT_DECAY 0.05 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 1e-4 0.01 80 4 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=adamw LR=1e-4 WD=0.01 EPOCH=80 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 1e-4 OPTIM.WEIGHT_DECAY 0.01 OPTIM.MAX_EPOCH 80 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 1e-4 0.01 80 4 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=adamw LR=1e-4 WD=0.01 EPOCH=80 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 1e-4 OPTIM.WEIGHT_DECAY 0.01 OPTIM.MAX_EPOCH 80 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 1e-4 0.01 80 4 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=adamw LR=1e-4 WD=0.01 EPOCH=80 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME adamw OPTIM.LR 1e-4 OPTIM.WEIGHT_DECAY 0.01 OPTIM.MAX_EPOCH 80 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 2e-4 0.02 120 8 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=adamw LR=2e-4 WD=0.02 EPOCH=120 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 2e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 120 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 2e-4 0.02 120 8 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=adamw LR=2e-4 WD=0.02 EPOCH=120 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 2e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 120 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 2e-4 0.02 120 8 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=adamw LR=2e-4 WD=0.02 EPOCH=120 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME adamw OPTIM.LR 2e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 120 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 3e-4 0.02 160 8 True end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=adamw LR=3e-4 WD=0.02 EPOCH=160 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 3e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 160 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 3e-4 0.02 160 8 True end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=adamw LR=3e-4 WD=0.02 EPOCH=160 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 3e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 160 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 3e-4 0.02 160 8 True end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=adamw LR=3e-4 WD=0.02 EPOCH=160 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr3e-4_wd0.02_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME adamw OPTIM.LR 3e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 160 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 5e-4 0.02 200 16 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=adamw LR=5e-4 WD=0.02 EPOCH=200 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 5e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 5e-4 0.02 200 16 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=adamw LR=5e-4 WD=0.02 EPOCH=200 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 5e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 5e-4 0.02 200 16 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=adamw LR=5e-4 WD=0.02 EPOCH=200 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr5e-4_wd0.02_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME adamw OPTIM.LR 5e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 8e-4 0.05 200 16 True middle cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=1 OPT=adamw LR=8e-4 WD=0.05 EPOCH=200 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 8e-4 OPTIM.WEIGHT_DECAY 0.05 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 8e-4 0.05 200 16 True middle cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=1 OPT=adamw LR=8e-4 WD=0.05 EPOCH=200 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 8e-4 OPTIM.WEIGHT_DECAY 0.05 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 1 adamw 8e-4 0.05 200 16 True middle cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=1 OPT=adamw LR=8e-4 WD=0.05 EPOCH=200 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_1/k1_adamw_lr8e-4_wd0.05_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME adamw OPTIM.LR 8e-4 OPTIM.WEIGHT_DECAY 0.05 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 1
+ for SHOTS in 1 2 4 8 16
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 5e-4 0 50 4 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=sgd LR=5e-4 WD=0 EPOCH=50 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 5e-4 OPTIM.WEIGHT_DECAY 0 OPTIM.MAX_EPOCH 50 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 5e-4 0 50 4 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=sgd LR=5e-4 WD=0 EPOCH=50 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 5e-4 OPTIM.WEIGHT_DECAY 0 OPTIM.MAX_EPOCH 50 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 5e-4 0 50 4 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=2 OPT=sgd LR=5e-4 WD=0 EPOCH=50 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-4_wd0_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 5e-4 OPTIM.WEIGHT_DECAY 0 OPTIM.MAX_EPOCH 50 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 1e-3 5e-4 100 8 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=sgd LR=1e-3 WD=5e-4 EPOCH=100 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 1e-3 OPTIM.WEIGHT_DECAY 5e-4 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 1e-3 5e-4 100 8 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=sgd LR=1e-3 WD=5e-4 EPOCH=100 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 1e-3 OPTIM.WEIGHT_DECAY 5e-4 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 1e-3 5e-4 100 8 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=2 OPT=sgd LR=1e-3 WD=5e-4 EPOCH=100 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd5e-4_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 1e-3 OPTIM.WEIGHT_DECAY 5e-4 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 2e-3 1e-3 100 8 True end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=sgd LR=2e-3 WD=1e-3 EPOCH=100 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 2e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 2e-3 1e-3 100 8 True end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=sgd LR=2e-3 WD=1e-3 EPOCH=100 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 2e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 2e-3 1e-3 100 8 True end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=2 OPT=sgd LR=2e-3 WD=1e-3 EPOCH=100 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd1e-3_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 2e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 3e-3 1e-3 150 16 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=sgd LR=3e-3 WD=1e-3 EPOCH=150 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 3e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 3e-3 1e-3 150 16 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=sgd LR=3e-3 WD=1e-3 EPOCH=150 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 3e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 3e-3 1e-3 150 16 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=2 OPT=sgd LR=3e-3 WD=1e-3 EPOCH=150 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 3e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 5e-3 5e-3 150 16 True middle cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=sgd LR=5e-3 WD=5e-3 EPOCH=150 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 5e-3 OPTIM.WEIGHT_DECAY 5e-3 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 5e-3 5e-3 150 16 True middle cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=sgd LR=5e-3 WD=5e-3 EPOCH=150 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 5e-3 OPTIM.WEIGHT_DECAY 5e-3 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 5e-3 5e-3 150 16 True middle cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=2 OPT=sgd LR=5e-3 WD=5e-3 EPOCH=150 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd5e-3_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 5e-3 OPTIM.WEIGHT_DECAY 5e-3 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 1e-3 0 80 4 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=sgd LR=1e-3 WD=0 EPOCH=80 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 1e-3 OPTIM.WEIGHT_DECAY 0 OPTIM.MAX_EPOCH 80 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 1e-3 0 80 4 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=sgd LR=1e-3 WD=0 EPOCH=80 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 1e-3 OPTIM.WEIGHT_DECAY 0 OPTIM.MAX_EPOCH 80 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 1e-3 0 80 4 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=2 OPT=sgd LR=1e-3 WD=0 EPOCH=80 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr1e-3_wd0_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 1e-3 OPTIM.WEIGHT_DECAY 0 OPTIM.MAX_EPOCH 80 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 2e-3 5e-4 120 8 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=sgd LR=2e-3 WD=5e-4 EPOCH=120 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 2e-3 OPTIM.WEIGHT_DECAY 5e-4 OPTIM.MAX_EPOCH 120 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 2e-3 5e-4 120 8 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=sgd LR=2e-3 WD=5e-4 EPOCH=120 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 2e-3 OPTIM.WEIGHT_DECAY 5e-4 OPTIM.MAX_EPOCH 120 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 2e-3 5e-4 120 8 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=2 OPT=sgd LR=2e-3 WD=5e-4 EPOCH=120 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr2e-3_wd5e-4_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 2e-3 OPTIM.WEIGHT_DECAY 5e-4 OPTIM.MAX_EPOCH 120 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 3e-3 1e-3 160 8 True end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=sgd LR=3e-3 WD=1e-3 EPOCH=160 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 3e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 160 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 3e-3 1e-3 160 8 True end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=sgd LR=3e-3 WD=1e-3 EPOCH=160 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 3e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 160 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 3e-3 1e-3 160 8 True end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=2 OPT=sgd LR=3e-3 WD=1e-3 EPOCH=160 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr3e-3_wd1e-3_ep160_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 3e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 160 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 5e-3 1e-3 200 16 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=sgd LR=5e-3 WD=1e-3 EPOCH=200 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 5e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 5e-3 1e-3 200 16 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=sgd LR=5e-3 WD=1e-3 EPOCH=200 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 5e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 5e-3 1e-3 200 16 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=2 OPT=sgd LR=5e-3 WD=1e-3 EPOCH=200 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr5e-3_wd1e-3_ep200_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 5e-3 OPTIM.WEIGHT_DECAY 1e-3 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 8e-3 5e-3 200 16 True middle cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=sgd LR=8e-3 WD=5e-3 EPOCH=200 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME sgd OPTIM.LR 8e-3 OPTIM.WEIGHT_DECAY 5e-3 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 8e-3 5e-3 200 16 True middle cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=sgd LR=8e-3 WD=5e-3 EPOCH=200 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME sgd OPTIM.LR 8e-3 OPTIM.WEIGHT_DECAY 5e-3 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 sgd 8e-3 5e-3 200 16 True middle cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=2 OPT=sgd LR=8e-3 WD=5e-3 EPOCH=200 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_sgd_lr8e-3_wd5e-3_ep200_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME sgd OPTIM.LR 8e-3 OPTIM.WEIGHT_DECAY 5e-3 OPTIM.MAX_EPOCH 200 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 5e-5 0.01 50 4 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=adamw LR=5e-5 WD=0.01 EPOCH=50 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 5e-5 OPTIM.WEIGHT_DECAY 0.01 OPTIM.MAX_EPOCH 50 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 5e-5 0.01 50 4 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=adamw LR=5e-5 WD=0.01 EPOCH=50 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 5e-5 OPTIM.WEIGHT_DECAY 0.01 OPTIM.MAX_EPOCH 50 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 5e-5 0.01 50 4 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=2 OPT=adamw LR=5e-5 WD=0.01 EPOCH=50 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-5_wd0.01_ep50_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME adamw OPTIM.LR 5e-5 OPTIM.WEIGHT_DECAY 0.01 OPTIM.MAX_EPOCH 50 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 1e-4 0.02 100 8 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=adamw LR=1e-4 WD=0.02 EPOCH=100 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 1e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 1e-4 0.02 100 8 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=adamw LR=1e-4 WD=0.02 EPOCH=100 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 1e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 1e-4 0.02 100 8 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=2 OPT=adamw LR=1e-4 WD=0.02 EPOCH=100 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.02_ep100_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME adamw OPTIM.LR 1e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 2e-4 0.02 100 8 True end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=adamw LR=2e-4 WD=0.02 EPOCH=100 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 2e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 2e-4 0.02 100 8 True end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=adamw LR=2e-4 WD=0.02 EPOCH=100 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 2e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 2e-4 0.02 100 8 True end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=2 OPT=adamw LR=2e-4 WD=0.02 EPOCH=100 NCTX=8 CSC=True CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr2e-4_wd0.02_ep100_n8_cscTrue_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME adamw OPTIM.LR 2e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 100 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 3e-4 0.02 150 16 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=adamw LR=3e-4 WD=0.02 EPOCH=150 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 3e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 3e-4 0.02 150 16 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=adamw LR=3e-4 WD=0.02 EPOCH=150 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 3e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 3e-4 0.02 150 16 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=2 OPT=adamw LR=3e-4 WD=0.02 EPOCH=150 NCTX=16 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr3e-4_wd0.02_ep150_n16_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME adamw OPTIM.LR 3e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 5e-4 0.05 150 16 True middle cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=adamw LR=5e-4 WD=0.05 EPOCH=150 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 5e-4 OPTIM.WEIGHT_DECAY 0.05 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 5e-4 0.05 150 16 True middle cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=adamw LR=5e-4 WD=0.05 EPOCH=150 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 5e-4 OPTIM.WEIGHT_DECAY 0.05 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 5e-4 0.05 150 16 True middle cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=2 OPT=adamw LR=5e-4 WD=0.05 EPOCH=150 NCTX=16 CSC=True CTP=middle SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr5e-4_wd0.05_ep150_n16_cscTrue_ctpmiddle_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME adamw OPTIM.LR 5e-4 OPTIM.WEIGHT_DECAY 0.05 OPTIM.MAX_EPOCH 150 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 1e-4 0.01 80 4 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=adamw LR=1e-4 WD=0.01 EPOCH=80 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 1e-4 OPTIM.WEIGHT_DECAY 0.01 OPTIM.MAX_EPOCH 80 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 1e-4 0.01 80 4 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=adamw LR=1e-4 WD=0.01 EPOCH=80 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 1e-4 OPTIM.WEIGHT_DECAY 0.01 OPTIM.MAX_EPOCH 80 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 1e-4 0.01 80 4 False end cosine 0 linear 0 0.20 self_attn 3 0
+ local SHOTS=2 OPT=adamw LR=1e-4 WD=0.01 EPOCH=80 NCTX=4 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=3 GPU=0
+ local TAG=k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 3 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr1e-4_wd0.01_ep80_n4_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed3 OPTIM.NAME adamw OPTIM.LR 1e-4 OPTIM.WEIGHT_DECAY 0.01 OPTIM.MAX_EPOCH 80 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for spec in "${SPECS[@]}"
+ IFS='|'
+ read -r OPT LR WD EPOCH NCTX CSC CTP SCHED WARMUP WU_TYPE CONS_LR RATIO ADAPTER
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 2e-4 0.02 120 8 False end cosine 0 linear 0 0.20 self_attn 1 0
+ local SHOTS=2 OPT=adamw LR=2e-4 WD=0.02 EPOCH=120 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=1 GPU=0
+ local TAG=k2_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 1 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed1 OPTIM.NAME adamw OPTIM.LR 2e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 120 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
+ for SEED in "${SEEDS[@]}"
++ choose_gpu
++ mapfile -t frees
+++ nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits
++ local best=-1 best_free=-1
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt -1 ]]
++ best=0
++ best_free=24200
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24200
++ [[ 24200 -ge 20000 ]]
++ [[ 24200 -gt 24200 ]]
++ for id in "${GPUS[@]}"
++ local free=24133
++ [[ 24133 -ge 20000 ]]
++ [[ 24133 -gt 24200 ]]
++ echo 0
+ gpu=0
+ [[ 0 == \-\1 ]]
+ run_one 2 adamw 2e-4 0.02 120 8 False end cosine 0 linear 0 0.20 self_attn 2 0
+ local SHOTS=2 OPT=adamw LR=2e-4 WD=0.02 EPOCH=120 NCTX=8 CSC=False CTP=end SCHED=cosine WARMUP=0 WU_TYPE=linear CONS_LR=0 RATIO=0.20 ADAPTER=self_attn SEED=2 GPU=0
+ local TAG=k2_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ local OUTDIR=output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ mkdir -p output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ CONS_LR_ARG=()
+ local CONS_LR_ARG
+ [[ linear == \c\o\n\s\t\a\n\t ]]
+ echo '[LAUNCH][GPU 0] oxford_pets k2_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2'
[LAUNCH][GPU 0] oxford_pets k2_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2
+ sleep 2
+ CUDA_VISIBLE_DEVICES=0
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ python train.py --root /data1/suho/DATA --seed 2 --trainer CLIP_Adapter_gpt --dataset-config-file configs/datasets/oxford_pets.yaml --config-file configs/trainers/CLIP_Adapter_gpt/vit_b16_c16_ep10_batch1.yaml --output-dir output/oxford_pets_vdt_adapter_vitb16_k1_2_4_8_16/shots_2/k2_adamw_lr2e-4_wd0.02_ep120_n8_cscFalse_ctpend_cosine_wu0_linear_cl0_ratio0.20_self_attn_seed2 OPTIM.NAME adamw OPTIM.LR 2e-4 OPTIM.WEIGHT_DECAY 0.02 OPTIM.MAX_EPOCH 120 OPTIM.LR_SCHEDULER cosine OPTIM.WARMUP_EPOCH 0 OPTIM.WARMUP_TYPE linear TRAINER.CLIP_ADAPTER.RATIO 0.20 TRAINER.CLIP_ADAPTER.WORD_ADAPTER_TYPE self_attn DATASET.NUM_SHOTS 2
